<beans:beans xmlns="http://www.springframework.org/schema/batch" 
     xmlns:beans="http://www.springframework.org/schema/beans"
     xmlns:context="http://www.springframework.org/schema/context"
     xmlns:batch="http://www.springframework.org/schema/batch" 
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="
           http://www.springframework.org/schema/beans 
           http://www.springframework.org/schema/beans/spring-beans-4.0.xsd
           http://www.springframework.org/schema/context
           http://www.springframework.org/schema/context/spring-context.xsd
           http://www.springframework.org/schema/batch 
           http://www.springframework.org/schema/batch/spring-batch-3.0.xsd">

	<beans:import resource="classpath:config/Sbatch-common.xml"/>
	
	<!-- READERS DEMO -->
		<!-- <beans:import resource="sbatch-cop-impl/Sbatch-COP-01-FlatFiles.xml"/>	 -->
		<!-- <beans:import resource="sbatch-cop-impl/Sbatch-COP-02-Xml.xml"/>	-->  
		<!-- <beans:import resource="sbatch-cop-impl/Sbatch-COP-03-Jdbc-Cursor.xml"/> -->
		<!-- <beans:import resource="sbatch-cop-impl/Sbatch-COP-04-Jdbc-Paging.xml"/> -->	
		
	<!-- ADAPTERS DEMO --> <!-- da commentare mioProcessor successivo -->
		<!--<beans:import resource="sbatch-cop-impl/Sbatch-COP-05-Adapters.xml"/>-->
			
	<!-- PROCESSORS DEMO -->
		<!-- DEFAULT PROCESSOR (FOR READERS DEMO) -->	
		<!--<beans:bean id="mioProcessor" class="corso.spring.batch.demo.cop.processors.BonificoProcessor" />  -->
				
		<!-- PROCESSOR CHAINED PROCESSORS DEMO -->	
		<!--<beans:import resource="sbatch-cop-impl/Sbatch-COP-06-ChainedProcessors.xml"/>  -->
		
	<!-- CUSTOM READERS -->
		<!--<beans:import resource="sbatch-cop-impl/Sbatch-COP-07-StreamReader.xml"/>  -->
		<beans:import resource="sbatch-cop-impl/Sbatch-COP-07-Streams.xml"/>
	 
   	<batch:job id="copDemoSampleJob" job-repository="domainJobRepository" >
		<batch:step id="copDemoSampleJobChunk">
			<batch:tasklet>
				<batch:chunk 	reader="mioReader" 
								processor="mioProcessor" 
								writer="mioWriter"
								commit-interval="5" 
				/>
			</batch:tasklet>
		</batch:step>	
	</batch:job>
	
	 	<batch:job id="copDemoSampleWithExceptionJob" job-repository="domainJobRepository" restartable="true">
			<batch:step id="copDemoSampleWithExceptionJobChunk" >
				<batch:tasklet>
					<batch:chunk 	reader="mioReader" 
								processor="mioProcessor" 
								writer="mioWriter"
								commit-interval="5" 							
								skip-limit="30"								
								retry-limit="10"								
								>
									
			    	<batch:skippable-exception-classes>
	      				<batch:include class="corso.spring.batch.demo.modulo.exceptions.SkipThresholdException" />
	      				<!--  <batch:include class="corso.spring.batch.demo.modulo.exceptions.RetryFactorException" />		-->		    			 	
	    			</batch:skippable-exception-classes>
	    			
					  <batch:retryable-exception-classes>				    					  
	      				<batch:include class="corso.spring.batch.demo.modulo.exceptions.RetryFactorException" />
	    			</batch:retryable-exception-classes>
	    			
	    		</batch:chunk>
			</batch:tasklet>
		</batch:step>	
	</batch:job>
	
	
	<!-- Necessario per contesto di business services -->
	<context:annotation-config />
    <context:component-scan 
		base-package="corso.spring.batch.demo.cop.services" />
		
</beans:beans>